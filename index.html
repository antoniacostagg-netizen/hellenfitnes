<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hellen Moda Fitness</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-storage-compat.js"></script>
    
    <style>
        /* ===== ESTILOS GERAIS ===== */
        :root {
            --primary-color: #ff6b6b;
            --secondary-color: #4ecdc4;
            --dark-color: #292f36;
            --light-color: #f7fff7;
            --accent-color: #ffe66d;
            --font-main: 'Arial', sans-serif;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font-main);
            background-color: var(--light-color);
            color: var(--dark-color);
            overflow-x: hidden;
        }
        
        /* ===== HEADER ===== */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background-color: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .logo {
            height: 50px;
            width: auto;
        }
        
        .header-icons {
            display: flex;
            gap: 15px;
        }
        
        .icon {
            font-size: 24px;
            cursor: pointer;
        }
        
        .top-message {
            background-color: var(--primary-color);
            color: white;
            text-align: center;
            padding: 10px;
            font-size: 14px;
        }
        
        /* ===== MENU LATERAL ===== */
        .side-menu {
            position: fixed;
            top: 0;
            right: -300px;
            width: 300px;
            height: 100%;
            background-color: white;
            box-shadow: -2px 0 10px rgba(0,0,0,0.1);
            transition: right 0.3s ease;
            z-index: 200;
            padding: 20px;
        }
        
        .side-menu.active {
            right: 0;
        }
        
        .menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .close-menu {
            font-size: 24px;
            cursor: pointer;
        }
        
        .menu-items {
            list-style: none;
        }
        
        .menu-items li {
            padding: 15px 0;
            border-bottom: 1px solid #eee;
        }
        
        .menu-items a {
            text-decoration: none;
            color: var(--dark-color);
            font-size: 18px;
        }
        
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 150;
            display: none;
        }
        
        .overlay.active {
            display: block;
        }
        
        /* ===== CAT√ÅLOGO DE PRODUTOS ===== */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            padding: 20px;
        }
        
        .product-card {
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .product-card:hover {
            transform: translateY(-5px);
        }
        
        .product-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
            cursor: pointer;
        }
        
        .thumbnails {
            display: flex;
            justify-content: center;
            gap: 5px;
            padding: 10px;
        }
        
        .thumbnail {
            width: 50px;
            height: 50px;
            object-fit: cover;
            border-radius: 5px;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }
        
        .thumbnail.active {
            opacity: 1;
            border: 2px solid var(--primary-color);
        }
        
        .product-info {
            padding: 15px;
        }
        
        .product-name {
            font-size: 18px;
            margin-bottom: 5px;
        }
        
        .product-price {
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        
        .buy-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
            transition: background-color 0.3s ease;
        }
        
        .buy-btn:hover {
            background-color: #e55a5a;
        }
        
        /* ===== MODAL DO PRODUTO ===== */
        .product-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 300;
            display: none;
        }
        
        .product-modal.active {
            display: flex;
        }
        
        .modal-content {
            background-color: white;
            width: 90%;
            max-width: 800px;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }
        
        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 24px;
            cursor: pointer;
            z-index: 10;
            background-color: rgba(255,255,255,0.8);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .carousel {
            position: relative;
            height: 400px;
            overflow: hidden;
        }
        
        .carousel-images {
            display: flex;
            transition: transform 0.5s ease;
            height: 100%;
        }
        
        .carousel-image {
            min-width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .carousel-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background-color: rgba(255,255,255,0.7);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            z-index: 5;
        }
        
        .prev-btn {
            left: 15px;
        }
        
        .next-btn {
            right: 15px;
        }
        
        .product-details {
            padding: 20px;
        }
        
        .color-options {
            margin: 20px 0;
        }
        
        .color-option {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding: 10px;
            border: 1px solid #eee;
            border-radius: 5px;
        }
        
        .color-name {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .color-swatch {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 1px solid #ddd;
        }
        
        .quantity-input {
            width: 60px;
            padding: 5px;
            text-align: center;
            border: 1px solid #ddd;
            border-radius: 3px;
        }
        
        .add-to-cart-btn {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            font-size: 18px;
            margin-top: 20px;
            transition: background-color 0.3s ease;
        }
        
        .add-to-cart-btn:hover {
            background-color: #3dbab3;
        }
        
        /* ===== CARRINHO ===== */
        .cart-sidebar {
            position: fixed;
            top: 0;
            right: -400px;
            width: 100%;
            max-width: 400px;
            height: 100%;
            background-color: white;
            box-shadow: -2px 0 10px rgba(0,0,0,0.1);
            transition: right 0.3s ease;
            z-index: 200;
            padding: 20px;
            overflow-y: auto;
        }
        
        .cart-sidebar.active {
            right: 0;
        }
        
        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .cart-items {
            margin-bottom: 20px;
        }
        
        .cart-item {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .cart-item-image {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 5px;
        }
        
        .cart-item-details {
            flex: 1;
        }
        
        .cart-item-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .cart-item-color {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .cart-item-quantity {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .quantity-btn {
            background-color: #eee;
            border: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            cursor: pointer;
        }
        
        .remove-item {
            color: #ff6b6b;
            cursor: pointer;
            margin-left: auto;
        }
        
        .cart-total {
            font-weight: bold;
            font-size: 18px;
            text-align: right;
            margin-bottom: 20px;
        }
        
        .checkout-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            font-size: 18px;
            transition: background-color 0.3s ease;
        }
        
        .checkout-btn:hover {
            background-color: #e55a5a;
        }
        
        /* ===== BOT√ÉO FLUTUANTE ===== */
        .floating-checkout {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            z-index: 100;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* ===== FORMUL√ÅRIO DE FINALIZA√á√ÉO ===== */
        .checkout-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 300;
            display: none;
        }
        
        .checkout-modal.active {
            display: flex;
        }
        
        .checkout-content {
            background-color: white;
            width: 90%;
            max-width: 600px;
            border-radius: 10px;
            overflow: hidden;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .checkout-header {
            padding: 20px;
            background-color: var(--dark-color);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .checkout-body {
            padding: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .order-summary {
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        
        .min-order-warning {
            background-color: #fff3cd;
            color: #856404;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .send-whatsapp-btn {
            background-color: #25D366;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            font-size: 18px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }
        
        /* ===== √ÅREA ADMINISTRATIVA ===== */
        .admin-login {
            max-width: 400px;
            margin: 50px auto;
            padding: 20px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .admin-panel {
            padding: 20px;
        }
        
        .admin-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        
        .admin-tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
        }
        
        .admin-tab.active {
            border-bottom: 3px solid var(--primary-color);
            font-weight: bold;
        }
        
        .admin-section {
            display: none;
        }
        
        .admin-section.active {
            display: block;
        }
        
        .product-form, .color-form {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        
        .inventory-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .inventory-table th, .inventory-table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        
        .inventory-table th {
            background-color: #f2f2f2;
        }
        
        .save-btn {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }
        
        /* ===== RESPONSIVIDADE ===== */
        @media (max-width: 768px) {
            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 10px;
                padding: 10px;
            }
            
            .product-image {
                height: 180px;
            }
            
            .carousel {
                height: 300px;
            }
            
            .cart-sidebar {
                width: 100%;
                max-width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Mensagem informativa -->
    <div class="top-message">
        Escolha seu produto e seu pedido ser√° enviado via WhatsApp.
    </div>
    
    <!-- Header -->
    <header>
        <img src="" alt="Logo" class="logo" id="site-logo">
        <div class="header-icons">
            <div class="icon" id="home-icon">üè†</div>
            <div class="icon" id="menu-icon">‚ò∞</div>
            <div class="icon" id="cart-icon">üõí</div>
        </div>
    </header>
    
    <!-- Menu lateral -->
    <div class="side-menu" id="side-menu">
        <div class="menu-header">
            <h3>Menu</h3>
            <div class="close-icon close-menu">‚úï</div>
        </div>
        <ul class="menu-items">
            <li><a href="#" data-category="all">Todos os produtos</a></li>
            <li><a href="#" data-category="conjuntos">Conjuntos</a></li>
            <li><a href="#" data-category="macaquinhos">Macaquinhos</a></li>
            <li><a href="#" data-category="tops">Tops</a></li>
            <li><a href="#" data-category="shorts">Shorts</a></li>
        </ul>
    </div>
    
    <!-- Overlay para menu e modais -->
    <div class="overlay" id="overlay"></div>
    
    <!-- Cat√°logo de produtos -->
    <main>
        <div class="products-grid" id="products-grid">
            <!-- Os produtos ser√£o carregados dinamicamente aqui -->
        </div>
    </main>
    
    <!-- Bot√£o flutuante de finalizar compra -->
    <button class="floating-checkout" id="floating-checkout">
        Finalizar Compra (<span id="cart-count">0</span>)
    </button>
    
    <!-- Modal do produto -->
    <div class="product-modal" id="product-modal">
        <div class="modal-content">
            <div class="close-modal">‚úï</div>
            <div class="carousel">
                <div class="carousel-images" id="carousel-images">
                    <!-- Imagens do carrossel ser√£o adicionadas aqui -->
                </div>
                <button class="carousel-btn prev-btn">‚Äπ</button>
                <button class="carousel-btn next-btn">‚Ä∫</button>
            </div>
            <div class="product-details">
                <h2 class="product-name" id="modal-product-name"></h2>
                <p class="product-price" id="modal-product-price"></p>
                <div class="color-options" id="color-options">
                    <!-- Op√ß√µes de cor ser√£o adicionadas aqui -->
                </div>
                <button class="add-to-cart-btn" id="add-to-cart">Adicionar ao Carrinho</button>
            </div>
        </div>
    </div>
    
    <!-- Carrinho lateral -->
    <div class="cart-sidebar" id="cart-sidebar">
        <div class="cart-header">
            <h3>Seu Carrinho</h3>
            <div class="close-icon close-cart">‚úï</div>
        </div>
        <div class="cart-items" id="cart-items">
            <!-- Itens do carrinho ser√£o adicionados aqui -->
        </div>
        <div class="cart-total">
            Total: R$ <span id="cart-total">0,00</span>
        </div>
        <button class="checkout-btn" id="checkout-btn">Finalizar Pedido</button>
    </div>
    
    <!-- Modal de finaliza√ß√£o de compra -->
    <div class="checkout-modal" id="checkout-modal">
        <div class="checkout-content">
            <div class="checkout-header">
                <h3>Finalizar Pedido</h3>
                <div class="close-icon close-checkout">‚úï</div>
            </div>
            <div class="checkout-body">
                <div class="min-order-warning">
                    Pedido m√≠nimo: 10 pe√ßas
                </div>
                <div class="order-summary" id="order-summary">
                    <!-- Resumo do pedido ser√° adicionado aqui -->
                </div>
                <form id="checkout-form">
                    <div class="form-group">
                        <label for="customer-name">Nome:</label>
                        <input type="text" id="customer-name" required>
                    </div>
                    <div class="form-group">
                        <label for="customer-cep">CEP:</label>
                        <input type="text" id="customer-cep" required>
                        <small>O frete ser√° calculado quando o pedido for enviado via WhatsApp.</small>
                    </div>
                    <div class="form-group">
                        <label for="customer-address">Endere√ßo:</label>
                        <input type="text" id="customer-address" required>
                    </div>
                    <div class="form-group">
                        <label for="delivery-type">Tipo de entrega:</label>
                        <select id="delivery-type" required>
                            <option value="">Selecione</option>
                            <option value="transportadora">Transportadora</option>
                            <option value="excurs√µes">Excurs√µes</option>
                            <option value="uber">Uber</option>
                            <option value="correio">Correio</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="customer-phone">Telefone:</label>
                        <input type="tel" id="customer-phone" required>
                    </div>
                    <div class="form-group">
                        <label>Forma de pagamento:</label>
                        <p>Pagamento apenas via PIX</p>
                    </div>
                    <button type="button" class="send-whatsapp-btn" id="send-whatsapp">
                        Enviar pedido via WhatsApp
                    </button>
                </form>
            </div>
        </div>
    </div>
    
    <!-- √Årea administrativa (inicialmente oculta) -->
    <div id="admin-area" style="display: none;">
        <div class="admin-panel">
            <div class="admin-tabs">
                <div class="admin-tab active" data-tab="products">Gerenciar Produtos</div>
                <div class="admin-tab" data-tab="inventory">Controle de Estoque</div>
                <div class="admin-tab" data-tab="settings">Configura√ß√µes do Site</div>
            </div>
            
            <div class="admin-section active" id="products-section">
                <h3>Adicionar Novo Produto</h3>
                <div class="product-form">
                    <div class="form-group">
                        <label for="product-name">Nome do Produto:</label>
                        <input type="text" id="product-name">
                    </div>
                    <div class="form-group">
                        <label for="product-price">Pre√ßo (R$):</label>
                        <input type="number" id="product-price" step="0.01">
                    </div>
                    <div class="form-group">
                        <label for="product-category">Categoria:</label>
                        <select id="product-category">
                            <option value="conjuntos">Conjuntos</option>
                            <option value="macaquinhos">Macaquinhos</option>
                            <option value="tops">Tops</option>
                            <option value="shorts">Shorts</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="product-images">URLs das Imagens (separadas por v√≠rgula):</label>
                        <textarea id="product-images" placeholder="https://exemplo.com/imagem1.jpg, https://exemplo.com/imagem2.jpg, https://exemplo.com/imagem3.jpg"></textarea>
                    </div>
                    <div class="color-form">
                        <h4>Cores e Estoque</h4>
                        <div id="color-fields">
                            <!-- Campos de cor ser√£o adicionados dinamicamente -->
                        </div>
                        <button type="button" id="add-color">Adicionar Cor</button>
                    </div>
                    <button type="button" class="save-btn" id="save-product">Salvar Produto</button>
                </div>
                
                <h3>Produtos Existentes</h3>
                <div id="existing-products">
                    <!-- Lista de produtos existentes ser√° carregada aqui -->
                </div>
            </div>
            
            <div class="admin-section" id="inventory-section">
                <h3>Controle de Estoque</h3>
                <table class="inventory-table">
                    <thead>
                        <tr>
                            <th>Produto</th>
                            <th>Cor</th>
                            <th>Estoque</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody id="inventory-table-body">
                        <!-- Dados de estoque ser√£o carregados aqui -->
                    </tbody>
                </table>
            </div>
            
            <div class="admin-section" id="settings-section">
                <h3>Configura√ß√µes do Site</h3>
                <div class="form-group">
                    <label for="site-logo-url">URL da Logo:</label>
                    <input type="text" id="site-logo-url">
                    <button type="button" class="save-btn" id="save-logo">Salvar Logo</button>
                </div>
                <div class="form-group">
                    <label for="primary-color">Cor Prim√°ria:</label>
                    <input type="color" id="primary-color" value="#ff6b6b">
                    <button type="button" class="save-btn" id="save-colors">Salvar Cores</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Login administrativo -->
    <div class="admin-login" id="admin-login">
        <h3>√Årea Administrativa</h3>
        <div class="form-group">
            <label for="admin-email">Email:</label>
            <input type="email" id="admin-email">
        </div>
        <div class="form-group">
            <label for="admin-password">Senha:</label>
            <input type="password" id="admin-password">
        </div>
        <button type="button" class="save-btn" id="admin-login-btn">Entrar</button>
    </div>

    <script>
        // ===== CONFIGURA√á√ÉO DO FIREBASE - SUBSTITUA COM SEUS DADOS =====
        // COLE AQUI AS CONFIGURA√á√ïES DO SEU NOVO PROJETO FIREBASE
        const firebaseConfig = {
    apiKey: "AIzaSyAn5SPhZJPqR6IdQecnFnMwLdDm3efy4ko",
    authDomain: "hellen-moda-fitnes.firebaseapp.com",
    projectId: "hellen-moda-fitnes",
    storageBucket: "hellen-moda-fitnes.firebasestorage.app",
    messagingSenderId: "998940228851",
    appId: "1:998940228851:web:d4e8d3ac366c26fe9e4b86"
  };

        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const storage = firebase.storage();

        // ===== VARI√ÅVEIS GLOBAIS =====
        let currentUser = null;
        let products = [];
        let cart = [];
        let currentProduct = null;
        let currentImageIndex = 0;

        // ===== ELEMENTOS DO DOM =====
        const elements = {
            siteLogo: document.getElementById('site-logo'),
            homeIcon: document.getElementById('home-icon'),
            menuIcon: document.getElementById('menu-icon'),
            cartIcon: document.getElementById('cart-icon'),
            sideMenu: document.getElementById('side-menu'),
            overlay: document.getElementById('overlay'),
            closeMenu: document.querySelector('.close-menu'),
            menuItems: document.querySelectorAll('.menu-items a'),
            productsGrid: document.getElementById('products-grid'),
            productModal: document.getElementById('product-modal'),
            closeModal: document.querySelector('.close-modal'),
            carouselImages: document.getElementById('carousel-images'),
            prevBtn: document.querySelector('.prev-btn'),
            nextBtn: document.querySelector('.next-btn'),
            modalProductName: document.getElementById('modal-product-name'),
            modalProductPrice: document.getElementById('modal-product-price'),
            colorOptions: document.getElementById('color-options'),
            addToCartBtn: document.getElementById('add-to-cart'),
            cartSidebar: document.getElementById('cart-sidebar'),
            closeCart: document.querySelector('.close-cart'),
            cartItems: document.getElementById('cart-items'),
            cartTotal: document.getElementById('cart-total'),
            cartCount: document.getElementById('cart-count'),
            checkoutBtn: document.getElementById('checkout-btn'),
            floatingCheckout: document.getElementById('floating-checkout'),
            checkoutModal: document.getElementById('checkout-modal'),
            closeCheckout: document.querySelector('.close-checkout'),
            orderSummary: document.getElementById('order-summary'),
            checkoutForm: document.getElementById('checkout-form'),
            sendWhatsApp: document.getElementById('send-whatsapp'),
            adminArea: document.getElementById('admin-area'),
            adminLogin: document.getElementById('admin-login'),
            adminEmail: document.getElementById('admin-email'),
            adminPassword: document.getElementById('admin-password'),
            adminLoginBtn: document.getElementById('admin-login-btn'),
            adminTabs: document.querySelectorAll('.admin-tab'),
            adminSections: document.querySelectorAll('.admin-section'),
            productName: document.getElementById('product-name'),
            productPrice: document.getElementById('product-price'),
            productCategory: document.getElementById('product-category'),
            productImages: document.getElementById('product-images'),
            colorFields: document.getElementById('color-fields'),
            addColor: document.getElementById('add-color'),
            saveProduct: document.getElementById('save-product'),
            existingProducts: document.getElementById('existing-products'),
            inventoryTableBody: document.getElementById('inventory-table-body'),
            siteLogoUrl: document.getElementById('site-logo-url'),
            primaryColor: document.getElementById('primary-color'),
            saveLogo: document.getElementById('save-logo'),
            saveColors: document.getElementById('save-colors')
        };

        // ===== INICIALIZA√á√ÉO =====
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
            loadProducts();
            loadSiteSettings();
            checkAdminAuth();
        });

        function initializeApp() {
            const savedCart = localStorage.getItem('cart');
            if (savedCart) {
                cart = JSON.parse(savedCart);
                updateCartUI();
            }
            
            auth.onAuthStateChanged(user => {
                if (user) {
                    currentUser = user;
                    showAdminPanel();
                } else {
                    currentUser = null;
                    showAdminLogin();
                }
            });
        }

        function setupEventListeners() {
            elements.menuIcon.addEventListener('click', toggleMenu);
            elements.closeMenu.addEventListener('click', toggleMenu);
            elements.overlay.addEventListener('click', closeAllModals);
            elements.homeIcon.addEventListener('click', goToHome);
            elements.cartIcon.addEventListener('click', toggleCart);
            elements.closeCart.addEventListener('click', toggleCart);
            elements.floatingCheckout.addEventListener('click', openCheckout);
            
            elements.menuItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const category = this.getAttribute('data-category');
                    filterProducts(category);
                    toggleMenu();
                });
            });
            
            elements.closeModal.addEventListener('click', closeProductModal);
            elements.prevBtn.addEventListener('click', showPrevImage);
            elements.nextBtn.addEventListener('click', showNextImage);
            elements.addToCartBtn.addEventListener('click', addToCartFromModal);
            
            elements.closeCheckout.addEventListener('click', closeCheckout);
            elements.checkoutBtn.addEventListener('click', openCheckout);
            elements.sendWhatsApp.addEventListener('click', sendOrderViaWhatsApp);
            
            elements.adminLoginBtn.addEventListener('click', adminLogin);
            elements.adminTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    switchAdminTab(this.getAttribute('data-tab'));
                });
            });
            
            elements.addColor.addEventListener('click', addColorField);
            elements.saveProduct.addEventListener('click', saveProduct);
            elements.saveLogo.addEventListener('click', saveSiteLogo);
            elements.saveColors.addEventListener('click', saveSiteColors);
        }

        // ===== FUN√á√ïES DE UI =====
        function toggleMenu() {
            elements.sideMenu.classList.toggle('active');
            elements.overlay.classList.toggle('active');
        }

        function toggleCart() {
            elements.cartSidebar.classList.toggle('active');
            elements.overlay.classList.toggle('active');
        }

        function closeAllModals() {
            elements.sideMenu.classList.remove('active');
            elements.cartSidebar.classList.remove('active');
            elements.productModal.classList.remove('active');
            elements.checkoutModal.classList.remove('active');
            elements.overlay.classList.remove('active');
        }

        function goToHome() {
            window.scrollTo(0, 0);
            filterProducts('all');
        }

        function openProductModal(product) {
            currentProduct = product;
            currentImageIndex = 0;
            
            elements.modalProductName.textContent = product.name;
            elements.modalProductPrice.textContent = `R$ ${product.price.toFixed(2)}`;
            
            elements.carouselImages.innerHTML = '';
            product.images.forEach((image, index) => {
                const img = document.createElement('img');
                img.src = image;
                img.alt = product.name;
                img.className = 'carousel-image';
                if (index === 0) img.style.display = 'block';
                elements.carouselImages.appendChild(img);
            });
            
            elements.colorOptions.innerHTML = '';
            product.colors.forEach(color => {
                const colorOption = document.createElement('div');
                colorOption.className = 'color-option';
                colorOption.innerHTML = `
                    <div class="color-name">
                        <div class="color-swatch" style="background-color: ${color.hex}"></div>
                        <span>${color.name} (Estoque: ${color.stock})</span>
                    </div>
                    <input type="number" class="quantity-input" min="0" max="${color.stock}" value="0" data-color="${color.name}">
                `;
                elements.colorOptions.appendChild(colorOption);
            });
            
            elements.productModal.classList.add('active');
            elements.overlay.classList.add('active');
        }

        function closeProductModal() {
            elements.productModal.classList.remove('active');
            elements.overlay.classList.remove('active');
        }

        function showPrevImage() {
            if (currentImageIndex > 0) {
                currentImageIndex--;
                updateCarousel();
            }
        }

        function showNextImage() {
            if (currentImageIndex < currentProduct.images.length - 1) {
                currentImageIndex++;
                updateCarousel();
            }
        }

        function updateCarousel() {
            const images = document.querySelectorAll('.carousel-image');
            images.forEach((img, index) => {
                img.style.display = index === currentImageIndex ? 'block' : 'none';
            });
        }

        function openCheckout() {
            if (cart.length === 0) {
                alert('Seu carrinho est√° vazio!');
                return;
            }
            
            const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
            
            if (totalItems < 10) {
                alert(`Pedido m√≠nimo de 10 pe√ßas. Seu pedido atual tem ${totalItems} pe√ßas.`);
                return;
            }
            
            elements.orderSummary.innerHTML = '';
            cart.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'order-item';
                itemElement.innerHTML = `
                    <p>${item.name} - ${item.color} (${item.quantity}x) - R$ ${(item.price * item.quantity).toFixed(2)}</p>
                `;
                elements.orderSummary.appendChild(itemElement);
            });
            
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const totalElement = document.createElement('div');
            totalElement.className = 'order-total';
            totalElement.innerHTML = `<p><strong>Total: R$ ${total.toFixed(2)}</strong></p>`;
            elements.orderSummary.appendChild(totalElement);
            
            elements.checkoutModal.classList.add('active');
            elements.overlay.classList.add('active');
        }

        function closeCheckout() {
            elements.checkoutModal.classList.remove('active');
            elements.overlay.classList.remove('active');
        }

        // ===== FUN√á√ïES DO CARRINHO =====
        function addToCartFromModal() {
            const colorInputs = document.querySelectorAll('.quantity-input');
            let addedItems = false;
            
            colorInputs.forEach(input => {
                const quantity = parseInt(input.value);
                const colorName = input.getAttribute('data-color');
                
                if (quantity > 0) {
                    const color = currentProduct.colors.find(c => c.name === colorName);
                    
                    if (color && quantity <= color.stock) {
                        const cartItem = {
                            id: currentProduct.id,
                            name: currentProduct.name,
                            price: currentProduct.price,
                            color: colorName,
                            quantity: quantity,
                            image: currentProduct.images[0]
                        };
                        
                        const existingItemIndex = cart.findIndex(item => 
                            item.id === cartItem.id && item.color === cartItem.color
                        );
                        
                        if (existingItemIndex !== -1) {
                            cart[existingItemIndex].quantity += quantity;
                        } else {
                            cart.push(cartItem);
                        }
                        
                        addedItems = true;
                    } else {
                        alert(`Quantidade solicitada para ${colorName} excede o estoque dispon√≠vel.`);
                    }
                }
            });
            
            if (addedItems) {
                saveCart();
                updateCartUI();
                closeProductModal();
                alert('Itens adicionados ao carrinho!');
            } else {
                alert('Selecione pelo menos uma cor e quantidade para adicionar ao carrinho.');
            }
        }

        function updateCartUI() {
            const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
            elements.cartCount.textContent = totalItems;
            
            elements.cartItems.innerHTML = '';
            
            if (cart.length === 0) {
                elements.cartItems.innerHTML = '<p>Seu carrinho est√° vazio.</p>';
                elements.cartTotal.textContent = '0,00';
                return;
            }
            
            let total = 0;
            
            cart.forEach((item, index) => {
                const itemElement = document.createElement('div');
                itemElement.className = 'cart-item';
                itemElement.innerHTML = `
                    <img src="${item.image}" alt="${item.name}" class="cart-item-image">
                    <div class="cart-item-details">
                        <div class="cart-item-name">${item.name}</div>
                        <div class="cart-item-color">Cor: ${item.color}</div>
                        <div class="cart-item-quantity">
                            <button class="quantity-btn minus" data-index="${index}">-</button>
                            <span>${item.quantity}</span>
                            <button class="quantity-btn plus" data-index="${index}">+</button>
                        </div>
                    </div>
                    <div class="remove-item" data-index="${index}">‚úï</div>
                `;
                
                elements.cartItems.appendChild(itemElement);
                total += item.price * item.quantity;
            });
            
            elements.cartTotal.textContent = total.toFixed(2);
            
            document.querySelectorAll('.quantity-btn.minus').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    if (cart[index].quantity > 1) {
                        cart[index].quantity--;
                    } else {
                        cart.splice(index, 1);
                    }
                    saveCart();
                    updateCartUI();
                });
            });
            
            document.querySelectorAll('.quantity-btn.plus').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    const product = products.find(p => p.id === cart[index].id);
                    if (product) {
                        const color = product.colors.find(c => c.name === cart[index].color);
                        if (color && cart[index].quantity < color.stock) {
                            cart[index].quantity++;
                            saveCart();
                            updateCartUI();
                        } else {
                            alert('Quantidade m√°xima em estoque atingida para esta cor.');
                        }
                    }
                });
            });
            
            document.querySelectorAll('.remove-item').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    cart.splice(index, 1);
                    saveCart();
                    updateCartUI();
                });
            });
        }

        function saveCart() {
            localStorage.setItem('cart', JSON.stringify(cart));
        }

        // ===== FINALIZA√á√ÉO DO PEDIDO =====
        function sendOrderViaWhatsApp() {
            if (!elements.checkoutForm.checkValidity()) {
                alert('Por favor, preencha todos os campos obrigat√≥rios.');
                return;
            }
            
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
            
            let message = `Ol√°! Gostaria de fazer um pedido:\n\n`;
            
            cart.forEach(item => {
                message += `‚Ä¢ ${item.name} - ${item.color} (${item.quantity}x) - R$ ${(item.price * item.quantity).toFixed(2)}\n`;
            });
            
            message += `\nTotal: R$ ${total.toFixed(2)} (${totalItems} pe√ßas)\n\n`;
            message += `Dados do cliente:\n`;
            message += `Nome: ${document.getElementById('customer-name').value}\n`;
            message += `CEP: ${document.getElementById('customer-cep').value}\n`;
            message += `Endere√ßo: ${document.getElementById('customer-address').value}\n`;
            message += `Tipo de entrega: ${document.getElementById('delivery-type').value}\n`;
            message += `Telefone: ${document.getElementById('customer-phone').value}\n`;
            message += `Forma de pagamento: PIX`;
            
            const encodedMessage = encodeURIComponent(message);
            const phoneNumber = "5511999999999"; // ALTERE PARA SEU N√öMERO
            
            window.open(`https://wa.me/${phoneNumber}?text=${encodedMessage}`, '_blank');
            
            cart = [];
            saveCart();
            updateCartUI();
            closeCheckout();
            
            alert('Pedido enviado via WhatsApp! Em breve entraremos em contato.');
        }

        // ===== CAT√ÅLOGO DE PRODUTOS =====
        function loadProducts() {
            db.collection('products').get()
                .then(snapshot => {
                    products = [];
                    snapshot.forEach(doc => {
                        const product = doc.data();
                        product.id = doc.id;
                        products.push(product);
                    });
                    displayProducts(products);
                })
                .catch(error => {
                    console.error('Erro ao carregar produtos:', error);
                });
        }

        function displayProducts(productsToShow) {
            elements.productsGrid.innerHTML = '';
            
            if (productsToShow.length === 0) {
                elements.productsGrid.innerHTML = '<p>Nenhum produto encontrado.</p>';
                return;
            }
            
            productsToShow.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                productCard.innerHTML = `
                    <img src="${product.images[0]}" alt="${product.name}" class="product-image">
                    <div class="thumbnails">
                        ${product.images.slice(0, 3).map((image, index) => 
                            `<img src="${image}" alt="${product.name}" class="thumbnail ${index === 0 ? 'active' : ''}" data-index="${index}">`
                        ).join('')}
                    </div>
                    <div class="product-info">
                        <h3 class="product-name">${product.name}</h3>
                        <p class="product-price">R$ ${product.price.toFixed(2)}</p>
                        <button class="buy-btn" data-id="${product.id}">Comprar</button>
                    </div>
                `;
                
                elements.productsGrid.appendChild(productCard);
                
                const thumbnails = productCard.querySelectorAll('.thumbnail');
                const mainImage = productCard.querySelector('.product-image');
                
                thumbnails.forEach(thumbnail => {
                    thumbnail.addEventListener('click', function() {
                        const index = parseInt(this.getAttribute('data-index'));
                        mainImage.src = product.images[index];
                        thumbnails.forEach(t => t.classList.remove('active'));
                        this.classList.add('active');
                    });
                });
                
                const buyBtn = productCard.querySelector('.buy-btn');
                buyBtn.addEventListener('click', function() {
                    const productId = this.getAttribute('data-id');
                    const product = products.find(p => p.id === productId);
                    if (product) {
                        openProductModal(product);
                    }
                });
            });
        }

        function filterProducts(category) {
            if (category === 'all') {
                displayProducts(products);
            } else {
                const filteredProducts = products.filter(product => product.category === category);
                displayProducts(filteredProducts);
            }
        }

        // ===== √ÅREA ADMINISTRATIVA =====
        function checkAdminAuth() {
            auth.onAuthStateChanged(user => {
                if (user) {
                    currentUser = user;
                    showAdminPanel();
                } else {
                    showAdminLogin();
                }
            });
        }

        function showAdminLogin() {
            elements.adminLogin.style.display = 'block';
            elements.adminArea.style.display = 'none';
        }

        function showAdminPanel() {
            elements.adminLogin.style.display = 'none';
            elements.adminArea.style.display = 'block';
            loadExistingProducts();
            loadInventory();
        }

        function adminLogin() {
            const email = elements.adminEmail.value;
            const password = elements.adminPassword.value;
            
            auth.signInWithEmailAndPassword(email, password)
                .then(userCredential => {
                    currentUser = userCredential.user;
                    showAdminPanel();
                })
                .catch(error => {
                    alert('Erro no login: ' + error.message);
                });
        }

        function switchAdminTab(tabName) {
            elements.adminTabs.forEach(tab => {
                if (tab.getAttribute('data-tab') === tabName) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });
            
            elements.adminSections.forEach(section => {
                if (section.id === `${tabName}-section`) {
                    section.classList.add('active');
                } else {
                    section.classList.remove('active');
                }
            });
        }

        function addColorField() {
            const colorField = document.createElement('div');
            colorField.className = 'color-field';
            colorField.innerHTML = `
                <div class="form-group">
                    <input type="text" placeholder="Nome da cor" class="color-name-input">
                    <input type="color" class="color-hex-input">
                    <input type="number" placeholder="Estoque" min="0" class="color-stock-input">
                    <button type="button" class="remove-color">Remover</button>
                </div>
            `;
            
            elements.colorFields.appendChild(colorField);
            
            colorField.querySelector('.remove-color').addEventListener('click', function() {
                colorField.remove();
            });
        }

        function saveProduct() {
            const name = elements.productName.value;
            const price = parseFloat(elements.productPrice.value);
            const category = elements.productCategory.value;
            const images = elements.productImages.value.split(',').map(url => url.trim());
            
            const colors = [];
            const colorFields = elements.colorFields.querySelectorAll('.color-field');
            
            colorFields.forEach(field => {
                const nameInput = field.querySelector('.color-name-input');
                const hexInput = field.querySelector('.color-hex-input');
                const stockInput = field.querySelector('.color-stock-input');
                
                if (nameInput.value && hexInput.value && stockInput.value) {
                    colors.push({
                        name: nameInput.value,
                        hex: hexInput.value,
                        stock: parseInt(stockInput.value)
                    });
                }
            });
            
            if (!name || !price || !category || images.length === 0 || colors.length === 0) {
                alert('Por favor, preencha todos os campos obrigat√≥rios.');
                return;
            }
            
            db.collection('products').add({
                name: name,
                price: price,
                category: category,
                images: images,
                colors: colors,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            })
            .then(() => {
                alert('Produto salvo com sucesso!');
                elements.productName.value = '';
                elements.productPrice.value = '';
                elements.productImages.value = '';
                elements.colorFields.innerHTML = '';
                loadProducts();
                loadExistingProducts();
            })
            .catch(error => {
                alert('Erro ao salvar produto: ' + error.message);
            });
        }

        function loadExistingProducts() {
            db.collection('products').get()
                .then(snapshot => {
                    elements.existingProducts.innerHTML = '<h4>Produtos Cadastrados</h4>';
                    
                    if (snapshot.empty) {
                        elements.existingProducts.innerHTML += '<p>Nenhum produto cadastrado.</p>';
                        return;
                    }
                    
                    snapshot.forEach(doc => {
                        const product = doc.data();
                        const productElement = document.createElement('div');
                        productElement.className = 'existing-product';
                        productElement.innerHTML = `
                            <p><strong>${product.name}</strong> - R$ ${product.price.toFixed(2)}</p>
                            <button class="delete-product" data-id="${doc.id}">Excluir</button>
                        `;
                        
                        elements.existingProducts.appendChild(productElement);
                        
                        productElement.querySelector('.delete-product').addEventListener('click', function() {
                            if (confirm('Tem certeza que deseja excluir este produto?')) {
                                db.collection('products').doc(doc.id).delete()
                                    .then(() => {
                                        alert('Produto exclu√≠do com sucesso!');
                                        loadExistingProducts();
                                        loadProducts();
                                    })
                                    .catch(error => {
                                        alert('Erro ao excluir produto: ' + error.message);
                                    });
                            }
                        });
                    });
                })
                .catch(error => {
                    console.error('Erro ao carregar produtos existentes:', error);
                });
        }

        function loadInventory() {
            db.collection('products').get()
                .then(snapshot => {
                    elements.inventoryTableBody.innerHTML = '';
                    
                    snapshot.forEach(doc => {
                        const product = doc.data();
                        product.id = doc.id;
                        
                        product.colors.forEach(color => {
                            const row = document.createElement('tr');
                            row.innerHTML = `
                                <td>${product.name}</td>
                                <td>${color.name}</td>
                                <td>
                                    <input type="number" value="${color.stock}" min="0" class="stock-input" data-product="${product.id}" data-color="${color.name}">
                                </td>
                                <td>
                                    <button class="save-stock" data-product="${product.id}" data-color="${color.name}">Salvar</button>
                                </td>
                            `;
                            
                            elements.inventoryTableBody.appendChild(row);
                            
                            row.querySelector('.save-stock').addEventListener('click', function() {
                                const newStock = parseInt(row.querySelector('.stock-input').value);
                                updateStock(product.id, color.name, newStock);
                            });
                        });
                    });
                })
                .catch(error => {
                    console.error('Erro ao carregar invent√°rio:', error);
                });
        }

        function updateStock(productId, colorName, newStock) {
            db.collection('products').doc(productId).get()
                .then(doc => {
                    if (doc.exists) {
                        const product = doc.data();
                        const updatedColors = product.colors.map(color => {
                            if (color.name === colorName) {
                                return { ...color, stock: newStock };
                            }
                            return color;
                        });
                        
                        return db.collection('products').doc(productId).update({
                            colors: updatedColors
                        });
                    }
                })
                .then(() => {
                    alert('Estoque atualizado com sucesso!');
                    loadProducts();
                    loadInventory();
                })
                .catch(error => {
                    alert('Erro ao atualizar estoque: ' + error.message);
                });
        }

        function loadSiteSettings() {
            db.collection('settings').doc('site').get()
                .then(doc => {
                    if (doc.exists) {
                        const settings = doc.data();
                        if (settings.logo) {
                            elements.siteLogo.src = settings.logo;
                            elements.siteLogoUrl.value = settings.logo;
                        }
                        if (settings.primaryColor) {
                            document.documentElement.style.setProperty('--primary-color', settings.primaryColor);
                            elements.primaryColor.value = settings.primaryColor;
                        }
                    }
                })
                .catch(error => {
                    console.error('Erro ao carregar configura√ß√µes:', error);
                });
        }

        function saveSiteLogo() {
            const logoUrl = elements.siteLogoUrl.value;
            
            if (!logoUrl) {
                alert('Por favor, insira uma URL para a logo.');
                return;
            }
            
            db.collection('settings').doc('site').set({
                logo: logoUrl
            }, { merge: true })
            .then(() => {
                elements.siteLogo.src = logoUrl;
                alert('Logo salva com sucesso!');
            })
            .catch(error => {
                alert('Erro ao salvar logo: ' + error.message);
            });
        }

        function saveSiteColors() {
            const primaryColor = elements.primaryColor.value;
            
            db.collection('settings').doc('site').set({
                primaryColor: primaryColor
            }, { merge: true })
            .then(() => {
                document.documentElement.style.setProperty('--primary-color', primaryColor);
                alert('Cores salvas com sucesso!');
            })
            .catch(error => {
                alert('Erro ao salvar cores: ' + error.message);
            });
        }
    </script>
</body>
</html>
